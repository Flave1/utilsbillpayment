@model SaveVendorModel
@{
    ViewBag.Title = Model.VendorId > 0 ? "Edit Vendor Details" : "Add Vendor Details";
    Layout = "~/Areas/Admin/Views/Shared/_AdminLayOut.cshtml";
}

<div class="container-fluid" id="pcont">
    <div class="page-head">
        <h2>@ViewBag.Title</h2>
    </div>

    <style>
        .field1{
            width:90%; 
        }
        label{
            float:left;
        }
    </style>
    <div class="cl-mcont">
        @Html.Partial("_FunctionCallMessage")
        <div class="row">
            <div class="col-md-12">
                <div class="block-flat">
                    <div class="header">
                        <h3>@ViewBag.Title</h3>
                    </div>
                    <div class="content people-form-cs">
                        <form class="form-horizontal" role="form" id="UserForm">
                            <div class="row" style="margin:10px;">
                                @Html.HiddenFor(x => x.VendorId)

                                <div class="row">
                                    <div class="col-md-7">
                                        <div class="row">
                                            <label for="inputEmail3" class="col-md-3">VENDOR NAME <em>* </em></label>
                                            @Html.TextBoxFor(x => x.Vendor, new { @class = "form-control  field1" })
                                            @Html.ValidationMessageFor(x => x.Vendor)
                                        </div>

                                    </div>
                                    <div class="col-md-7">
                                        <div class=" row ">
                                            <label for="inputEmail3" class="col-md-3">REP FIRST NAME<em>*</em></label>
                                            @Html.TextBoxFor(x => x.Name, new { @class = "form-control field1" })
                                            @Html.ValidationMessageFor(x => x.Name)
                                        </div>
                                    </div>

                                    <div class=" col-md-7">
                                        <div class="row">
                                            <label for="inputEmail3" class="col-md-3 ">REP LAST NAME<em>*</em></label>
                                            @Html.TextBoxFor(x => x.SurName, new { @class = "form-control field1" })
                                            @Html.ValidationMessageFor(x => x.SurName)
                                        </div>
                                    </div>
                                    <div class="col-md-12">
                                        <div class="row " style="width:30%;">
                                            <label for="inputEmail3" class="col-md-3 ">VENDOR EMAIL</label>
                                            @Html.TextBoxFor(x => x.Email, new { @class = "form-control field1" })
                                            @Html.ValidationMessageFor(x => x.Email)
                                        </div>
                                    </div>

                                    <div class="col-md-3">
                                        <div class="row">
                                            <label for="address" class="col-md-12 ">VENDOR ADDRESS</label>
                                            @Html.TextBoxFor(x => x.Address, new { @class = "form-control field1" })
                                            @Html.ValidationMessageFor(x => x.Email)
                                        </div>
                                    </div>
                                    <div class="col-md-2">
                                        <div class="row">
                                            <label for="inputEmail3" class="col-md-3">COUNTRY</label>
                                            <select class="form-control field1" name="Country" id="Country">
                                                <option value="">SELECT COUNTRY</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-md-2">
                                        <div class="row">
                                            <label for="inputEmail3" class="col-md-3">CITY</label>
                                            <select id="City" name="City" class="form-control field1">
                                                <option value="">SELECT CITY</option>
                                            </select>
                                        </div>
                                    </div>

                                </div>

                                <div class="row">
                                    <label for="inputEmail3" class="col-md-12">CELL PHONE<em>*</em></label>
                                    <div class="col-md-1">
                                        <select name="CountryCode" class="form-control">
                                            <option value="+232">+232</option>
                                        </select>
                                    </div>
                                    @Html.TextBoxFor(x => x.Phone, new { @class = "form-control field1" })
                                    @Html.ValidationMessageFor(x => x.Phone)
                                </div>

                                <div class="row">
                                    <div class="col-md-3">
                                        <label for="inputEmail3" style="width:100%;">AGENCY NAME</label>
                                        @Html.DropDownListFor(x => x.AgencyId, new SelectList(ViewBag.Agents, "value", "text"), null, new { @class = "form-control field1" })
                                        @Html.ValidationMessageFor(x => x.AgencyId)
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-3">
                                        <div class="row">
                                            <label for="inputEmail3" class="col-md-3">PASSWORD<em>*</em></label>
                                            @Html.PasswordFor(x => x.Password, new { @class = "form-control field1" })
                                            @Html.ValidationMessageFor(x => x.Password)
                                        </div>
                                    </div>
                                    <div class=" col-md-3">
                                        <div class="row">
                                            <label for="inputEmail3" class="col-md-12 ">RETYPE PASSWORD<em>*</em></label>
                                            @Html.PasswordFor(x => x.ConfirmPassword, new { @class = "form-control field1" })
                                            @Html.ValidationMessageFor(x => x.ConfirmPassword)
                                        </div>
                                    </div>
                                </div>

                                <div class="row">

                                    <div class="col-md-8" style="text-align:right;">
                                        <a href="@Url.Action("ManageVendors", "Vendor", new { area = "Admin" })" class="btn btn-default">Cancel</a>
                                        <input type="button" class="btn btn-primary" id="addUserBtn" value="Submit" />
                                    </div>

                                </div>
                            </div>
                        


                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@section scripts{
<script src="~/Scripts/AdminScripts/vendor.js"></script>
    <script type="text/javascript">
        $(document).ready(function () {
            App.init();
            if ('@Model.VendorId' !='0') {
                $("#Password").val('@Model.Password');
                $("#ConfirmPassword").val('@Model.Password');
            }
            debugger;
            $("#Country").change(onCountryChange);  
            loadAllCountries();
            loadAllCities();
             

            $("input[type=button]#saveProfileBtn").live("click", function () {
                return UpdateProfile($(this));
            }); 
        });


    
        function loadAllCountries() {
            var array = @Html.Raw(Json.Encode(ViewBag.countries));
            if (array.length > 0)
            { 
                for (var i = 0; i < array.length; i++) {
                    $("#Country").append("<option value=" + array[i].Value + ">" + array[i].Text + " </option>");
                } 
                var val = $("#Country").val('@Model.Country');
            }
        }
         
        function onCountryChange() {
            $("#City").empty();
            $("#City").append("<option value=''> SELECT CITY </option>") 
                var val = $("#Country").val();
                var array = @Html.Raw(Json.Encode(ViewBag.Cities));
                if (val) {
                    var records = array.filter(p => p.CountryId == val);
                    debugger;
                    if(records.length>0){

                        for (var i = 0; i < records.length; i++) {
                            $("#City").append("<option value=" + records[i].CityId + ">" + records[i].Name + " </option>");
                        } 
                    }
            } 
        }

        function loadAllCities() {
            var array = @Html.Raw(Json.Encode(ViewBag.Cities));
            if (array.length > 0)
            { 
                for (var i = 0; i < array.length; i++) {
                    $("#City").append("<option value=" + array[i].CityId + ">" + array[i].Name + " </option>");
                } 
                var val = $("#City").val('@Model.City');
            }
        }


    </script>
}